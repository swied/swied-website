<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.258">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-11-06">

<title>Scott’s Data Science Blog - Post Title</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: [{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: [],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-listing'] = new List('listing-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZZ12P3MMWN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZZ12P3MMWN', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<link rel="alternate" type="application/rss+xml" title="Scott's Data Science Blog" href="Untitled.xml"></head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Scott’s Data Science Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Post Title</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">PySpark</div>
                <div class="quarto-category">Pandas</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 6, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<div class="column-page-right">
<p>Intro…..</p>
<section id="install-pyspark" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="install-pyspark"><span class="header-section-number">1</span> Install PySpark</h2>
<p>Before we start this discussion I think it’s important to show how easy it is to install Pyspark. I recommend using Anaconda to do the PySpark installation. It only involves a few simple steps – assuming you already have Anaconda working. I won’t go into that here. I noticed that Pandas was one of the dependencies for the PySpark installation, so we kill two birds with one stone.</p>
<p>Open a Terminal and execute the following commands one at a time.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Terminal</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource {bash} number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1"><a href="#cb1-1"></a># Step 1: Activate your existing conda env</span>
<span id="cb1-2"><a href="#cb1-2"></a>conda activate pyspark_env</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a># Step 2: Install Open JDK</span>
<span id="cb1-5"><a href="#cb1-5"></a>conda install openjdk</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a># Step 3: Install Pyspark</span>
<span id="cb1-8"><a href="#cb1-8"></a>conda install pyspark</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a># Step 4: Install findspark in order to run Pyspark in a Jupyter notebook</span>
<span id="cb1-11"><a href="#cb1-11"></a>conda install -c conda-forge findspark</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="import-python-packages" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="import-python-packages"><span class="header-section-number">2</span> Import Python packages</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> pyspark.sql.types <span class="im">as</span> T</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">import</span> pyspark.sql.functions <span class="im">as</span> F</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="im">import</span> pyspark.sql.window <span class="im">as</span> W</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="im">from</span> pyspark.sql <span class="im">import</span> SparkSession</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Create a new spark session</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>spark <span class="op">=</span> SparkSession.builder.getOrCreate()</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># spark = SparkSession.builder.appName("intro").getOrCreate()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Check to see if our spark session is working</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>spark.sql(<span class="st">"select 'hello world' as greeting"</span>).show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+-----------+
|   greeting|
+-----------+
|hello world|
+-----------+
</code></pre>
</div>
</div>
</section>
<section id="create-some-data-frames-in-both-pandas-and-pyspark" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="create-some-data-frames-in-both-pandas-and-pyspark"><span class="header-section-number">3</span> Create some data frames in both Pandas and Pyspark</h2>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Field values</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>player_ids  <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>]</span>
<span id="cb6-3"><a href="#cb6-3"></a>first_names <span class="op">=</span> [<span class="st">'juan'</span>,<span class="st">'Manny'</span>,<span class="st">'Yu'</span>,<span class="st">'He-Seong'</span>,<span class="st">'JURICKSON'</span>,<span class="st">'jake'</span>,<span class="st">'Brandon'</span>,<span class="st">'JOSH'</span>,<span class="st">'Trent'</span>,<span class="st">'Austin'</span>]</span>
<span id="cb6-4"><a href="#cb6-4"></a>last_names  <span class="op">=</span> [<span class="st">'soto'</span>, <span class="st">'Machado'</span>, <span class="st">'Darvish'</span>, <span class="st">'Kim'</span>,<span class="st">'PROFAR'</span>,<span class="st">'cronenworth'</span>,<span class="st">'Drury'</span>,<span class="st">'BELL'</span>,<span class="st">'Grisham'</span>,<span class="st">'Nola'</span>]</span>
<span id="cb6-5"><a href="#cb6-5"></a>positions   <span class="op">=</span> [<span class="st">'RF'</span>,<span class="st">'3B'</span>,<span class="st">'P'</span>,<span class="st">'SS'</span>,<span class="st">'LF'</span>,<span class="st">'2B'</span>,<span class="st">'1B'</span>,<span class="st">'DH'</span>,<span class="st">'CF'</span>,<span class="st">'C'</span>]</span>
<span id="cb6-6"><a href="#cb6-6"></a>batting     <span class="op">=</span> [<span class="st">'L'</span>,<span class="st">'R'</span>,<span class="va">None</span>,<span class="st">'R'</span>,<span class="st">'S'</span>,<span class="st">'L'</span>,<span class="st">'R'</span>,<span class="st">'S'</span>,<span class="st">'L'</span>,<span class="st">'R'</span>]</span>
<span id="cb6-7"><a href="#cb6-7"></a>at_bats     <span class="op">=</span> [<span class="dv">524</span>,<span class="dv">578</span>,<span class="va">None</span>,<span class="dv">517</span>,<span class="dv">575</span>,<span class="dv">587</span>,<span class="dv">518</span>,<span class="dv">552</span>,<span class="dv">451</span>,<span class="dv">347</span>]</span>
<span id="cb6-8"><a href="#cb6-8"></a>obp         <span class="op">=</span> [<span class="fl">0.401</span>,<span class="fl">0.366</span>,<span class="va">None</span>,<span class="fl">0.325</span>,<span class="fl">0.331</span>,<span class="fl">0.332</span>,<span class="fl">0.320</span>,<span class="fl">0.362</span>,<span class="fl">0.284</span>,<span class="fl">0.321</span>]</span>
<span id="cb6-9"><a href="#cb6-9"></a>teams       <span class="op">=</span> [<span class="st">'Padres'</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="create-a-new-dataframe" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="create-a-new-dataframe"><span class="header-section-number">3.1</span> Create a New Dataframe</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Pyspark</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Create a new Pandas dataframe from the field lists from above</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'player_id'</span>:player_ids,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                   <span class="st">'team'</span>:teams,</span>
<span id="cb7-4"><a href="#cb7-4"></a>                   <span class="st">'first_name'</span>:first_names,</span>
<span id="cb7-5"><a href="#cb7-5"></a>                   <span class="st">'last_name'</span>:last_names,</span>
<span id="cb7-6"><a href="#cb7-6"></a>                   <span class="st">'position'</span>:positions,</span>
<span id="cb7-7"><a href="#cb7-7"></a>                   <span class="st">'batting_stance'</span>:batting,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                   <span class="st">'at_bats'</span>:at_bats,</span>
<span id="cb7-9"><a href="#cb7-9"></a>                   <span class="st">'obp'</span>:obp})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># If you are going to create a PySpark dataframe from inline code, then </span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># it is actually easiest to just create the dataframe in Pandas, and </span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># then convert it to Pyspark.  </span></span>
<span id="cb8-4"><a href="#cb8-4"></a>df <span class="op">=</span> spark.createDataFrame(</span>
<span id="cb8-5"><a href="#cb8-5"></a>    pd.DataFrame({<span class="st">'player_id'</span>:player_ids,</span>
<span id="cb8-6"><a href="#cb8-6"></a>                   <span class="st">'team'</span>:teams,</span>
<span id="cb8-7"><a href="#cb8-7"></a>                   <span class="st">'first_name'</span>:first_names,</span>
<span id="cb8-8"><a href="#cb8-8"></a>                   <span class="st">'last_name'</span>:last_names,</span>
<span id="cb8-9"><a href="#cb8-9"></a>                   <span class="st">'position'</span>:positions,</span>
<span id="cb8-10"><a href="#cb8-10"></a>                   <span class="st">'batting_stance'</span>:batting,</span>
<span id="cb8-11"><a href="#cb8-11"></a>                   <span class="st">'at_bats'</span>:at_bats,</span>
<span id="cb8-12"><a href="#cb8-12"></a>                   <span class="st">'obp'</span>:obp}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_id</th>
      <th>team</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>position</th>
      <th>batting_stance</th>
      <th>at_bats</th>
      <th>obp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Padres</td>
      <td>juan</td>
      <td>soto</td>
      <td>RF</td>
      <td>L</td>
      <td>524.0</td>
      <td>0.401</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Padres</td>
      <td>Manny</td>
      <td>Machado</td>
      <td>3B</td>
      <td>R</td>
      <td>578.0</td>
      <td>0.366</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Padres</td>
      <td>Yu</td>
      <td>Darvish</td>
      <td>P</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Padres</td>
      <td>He-Seong</td>
      <td>Kim</td>
      <td>SS</td>
      <td>R</td>
      <td>517.0</td>
      <td>0.325</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Padres</td>
      <td>JURICKSON</td>
      <td>PROFAR</td>
      <td>LF</td>
      <td>S</td>
      <td>575.0</td>
      <td>0.331</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="task-multiple-string-operations" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="task-multiple-string-operations"><span class="header-section-number">4</span> Task: Multiple String Operations</h2>
<p><strong>Task Description:</strong> (1) Notice that the capitalization is not consistent on the first and last names of the players. Fix this so that each name has only the first letter capitolized. (2) Create a new column showing the initials of each player.</p>
<section id="pandas-solution" class="level4" data-number="4.0.1">
<h4 data-number="4.0.1" class="anchored" data-anchor-id="pandas-solution"><span class="header-section-number">4.0.1</span> Pandas Solution</h4>
<p>I think it makes it more readable to chain together Pandas function calls by putting them inside of a set of parantheses. The <code>assign</code> function is useful for doing this sort of chaining.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Pyspark</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>df_task_1 <span class="op">=</span> (</span>
<span id="cb10-2"><a href="#cb10-2"></a>    df</span>
<span id="cb10-3"><a href="#cb10-3"></a>    <span class="co"># (1) Capitalize the first letter of both the first and last names</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>    .assign(first_name <span class="op">=</span> <span class="kw">lambda</span> x: x.first_name.<span class="bu">str</span>.title())</span>
<span id="cb10-5"><a href="#cb10-5"></a>    .assign(last_name  <span class="op">=</span> <span class="kw">lambda</span> x: x.last_name.<span class="bu">str</span>.title())</span>
<span id="cb10-6"><a href="#cb10-6"></a>    <span class="co"># (2) Creat a new field showing the initals of each player</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>    .assign(initials    <span class="op">=</span> <span class="kw">lambda</span> x: x.first_name.<span class="bu">str</span>[<span class="dv">0</span>:<span class="dv">1</span>] <span class="op">+</span> <span class="st">'.'</span> <span class="op">+</span> x.last_name.<span class="bu">str</span>[<span class="dv">0</span>:<span class="dv">1</span>] <span class="op">+</span> <span class="st">'.'</span>)</span>
<span id="cb10-8"><a href="#cb10-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>df_task_1 <span class="op">=</span> (</span>
<span id="cb11-2"><a href="#cb11-2"></a>    df</span>
<span id="cb11-3"><a href="#cb11-3"></a>    <span class="co"># (1) Capitalize the first letter of both the first and last names</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>    .withColumn(<span class="st">'first_name'</span>, F.initcap(F.col(<span class="st">'first_name'</span>)))</span>
<span id="cb11-5"><a href="#cb11-5"></a>    .withColumn(<span class="st">'last_name'</span>,  F.initcap(F.col(<span class="st">'last_name'</span>)))</span>
<span id="cb11-6"><a href="#cb11-6"></a>    <span class="co"># (2) Creat a new field showing the initals of each player</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>    .withColumn(<span class="st">'initials'</span>, F.concat(F.substring(<span class="st">'first_name'</span>,<span class="dv">0</span>,<span class="dv">1</span>), F.lit(<span class="st">'.'</span>), F.substring(<span class="st">'last_name'</span>, <span class="dv">0</span>, <span class="dv">1</span>), F.lit(<span class="st">'.'</span>)))</span>
<span id="cb11-8"><a href="#cb11-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>df_task_1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_id</th>
      <th>team</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>position</th>
      <th>batting_stance</th>
      <th>at_bats</th>
      <th>obp</th>
      <th>initials</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Padres</td>
      <td>Juan</td>
      <td>Soto</td>
      <td>RF</td>
      <td>L</td>
      <td>524.0</td>
      <td>0.401</td>
      <td>J.S.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Padres</td>
      <td>Manny</td>
      <td>Machado</td>
      <td>3B</td>
      <td>R</td>
      <td>578.0</td>
      <td>0.366</td>
      <td>M.M.</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Padres</td>
      <td>Yu</td>
      <td>Darvish</td>
      <td>P</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Y.D.</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Padres</td>
      <td>He-Seong</td>
      <td>Kim</td>
      <td>SS</td>
      <td>R</td>
      <td>517.0</td>
      <td>0.325</td>
      <td>H.K.</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Padres</td>
      <td>Jurickson</td>
      <td>Profar</td>
      <td>LF</td>
      <td>S</td>
      <td>575.0</td>
      <td>0.331</td>
      <td>J.P.</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>:::: {.columns} ::: {.column width=“50%”} ### Pyspark</p>
</section>
<section id="pandas-solution-1" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="pandas-solution-1"><span class="header-section-number">4.1</span> Pandas Solution</h3>
<section id="pandas-solution-1---using-the-apply-function" class="level4" data-number="4.1.1">
<h4 data-number="4.1.1" class="anchored" data-anchor-id="pandas-solution-1---using-the-apply-function"><span class="header-section-number">4.1.1</span> Pandas solution 1 - Using the <code>apply</code> function</h4>
<p>This is the most common way I that I have seen people solving this task after searching the internet. You need to look at it for a bit to understand what is going on. I’m not a big fan of the apply function. I think that list comprehensions are a more pythonic way of doing the same task.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>df_pandas[<span class="st">'full_name'</span>] <span class="op">=</span> df_pandas[[<span class="st">"first_name"</span>, <span class="st">"last_name"</span>]].<span class="bu">apply</span>(<span class="st">" "</span>.join, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>df_pandas.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_id</th>
      <th>team</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>position</th>
      <th>batting_stance</th>
      <th>at_bats</th>
      <th>obp</th>
      <th>full_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Padres</td>
      <td>juan</td>
      <td>soto</td>
      <td>RF</td>
      <td>L</td>
      <td>524.0</td>
      <td>0.401</td>
      <td>juan soto</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Padres</td>
      <td>Manny</td>
      <td>Machado</td>
      <td>3B</td>
      <td>R</td>
      <td>578.0</td>
      <td>0.366</td>
      <td>Manny Machado</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Padres</td>
      <td>Yu</td>
      <td>Darvish</td>
      <td>P</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Yu Darvish</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="pandas-solution-2---using-a-list-comprehension-and-an-f-string" class="level4" data-number="4.1.2">
<h4 data-number="4.1.2" class="anchored" data-anchor-id="pandas-solution-2---using-a-list-comprehension-and-an-f-string"><span class="header-section-number">4.1.2</span> Pandas solution 2 - Using a list comprehension and an f-string</h4>
<p>Here is a solution that uses the same technique as above, but with a list comprehension instead of an apply function. It may be a bit more “pythonic”, but it is still not pretty.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>df_pandas[<span class="st">'full_name'</span>] <span class="op">=</span> [<span class="ss">f"</span><span class="sc">{</span>x[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>x[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">zip</span>(df_pandas[<span class="st">"first_name"</span>], df_pandas[<span class="st">"last_name"</span>])]</span>
<span id="cb14-2"><a href="#cb14-2"></a>df_pandas.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_id</th>
      <th>team</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>position</th>
      <th>batting_stance</th>
      <th>at_bats</th>
      <th>obp</th>
      <th>full_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Padres</td>
      <td>juan</td>
      <td>soto</td>
      <td>RF</td>
      <td>L</td>
      <td>524.0</td>
      <td>0.401</td>
      <td>juan soto</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Padres</td>
      <td>Manny</td>
      <td>Machado</td>
      <td>3B</td>
      <td>R</td>
      <td>578.0</td>
      <td>0.366</td>
      <td>Manny Machado</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Padres</td>
      <td>Yu</td>
      <td>Darvish</td>
      <td>P</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Yu Darvish</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="pandas-solution-3---using-the-assign-function" class="level4" data-number="4.1.3">
<h4 data-number="4.1.3" class="anchored" data-anchor-id="pandas-solution-3---using-the-assign-function"><span class="header-section-number">4.1.3</span> Pandas solution 3 - Using the <code>assign</code> function</h4>
<p>This is my favorite Pandas solution. I like being able to change dataframe operations in series. I can use the <code>assign</code> function to accomplish this task. Unfortunately, like the previous 2 solutions, it is also bit ugly. It involves using a lambda function, a list comprehension, and the zip iterator function. It’s kind of crazy, but it all fits onto a single line. Once you memorize the pattern you can do this sort of assignment operation one line after another.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>(</span>
<span id="cb15-2"><a href="#cb15-2"></a>    df_pandas</span>
<span id="cb15-3"><a href="#cb15-3"></a>    .assign(full_name <span class="op">=</span> <span class="kw">lambda</span> x: [<span class="ss">f"</span><span class="sc">{</span>y[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>y[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> y <span class="kw">in</span> <span class="bu">zip</span>(x.first_name, x.last_name)])</span>
<span id="cb15-4"><a href="#cb15-4"></a>    .head(<span class="dv">3</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_id</th>
      <th>team</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>position</th>
      <th>batting_stance</th>
      <th>at_bats</th>
      <th>obp</th>
      <th>full_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Padres</td>
      <td>juan</td>
      <td>soto</td>
      <td>RF</td>
      <td>L</td>
      <td>524.0</td>
      <td>0.401</td>
      <td>juan soto</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Padres</td>
      <td>Manny</td>
      <td>Machado</td>
      <td>3B</td>
      <td>R</td>
      <td>578.0</td>
      <td>0.366</td>
      <td>Manny Machado</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Padres</td>
      <td>Yu</td>
      <td>Darvish</td>
      <td>P</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Yu Darvish</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="pyspark-solution" class="level4" data-number="4.1.4">
<h4 data-number="4.1.4" class="anchored" data-anchor-id="pyspark-solution"><span class="header-section-number">4.1.4</span> Pyspark solution</h4>
<p>I have saved the best solution for last. As you saw above, there is no straight forward way to accomplish this task using Pandas. This Pyspark solution is just as wordy. However, in my opinion, it way more straight forward. It is just a few funtion calls.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>(</span>
<span id="cb16-2"><a href="#cb16-2"></a>    df_pyspark</span>
<span id="cb16-3"><a href="#cb16-3"></a>    .withColumn(<span class="st">'full_name'</span>, F.concat(F.col(<span class="st">'first_name'</span>), F.lit(<span class="st">' '</span>), F.col(<span class="st">'last_name'</span>)))</span>
<span id="cb16-4"><a href="#cb16-4"></a>    .toPandas()</span>
<span id="cb16-5"><a href="#cb16-5"></a>    .head(<span class="dv">3</span>)</span>
<span id="cb16-6"><a href="#cb16-6"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_id</th>
      <th>team</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>position</th>
      <th>batting_stance</th>
      <th>at_bats</th>
      <th>obp</th>
      <th>full_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Padres</td>
      <td>juan</td>
      <td>soto</td>
      <td>RF</td>
      <td>L</td>
      <td>524.0</td>
      <td>0.401</td>
      <td>juan soto</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Padres</td>
      <td>Manny</td>
      <td>Machado</td>
      <td>3B</td>
      <td>R</td>
      <td>578.0</td>
      <td>0.366</td>
      <td>Manny Machado</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Padres</td>
      <td>Yu</td>
      <td>Darvish</td>
      <td>P</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Yu Darvish</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="task-2-apply-a-window-function" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="task-2-apply-a-window-function"><span class="header-section-number">4.2</span> Task 2: Apply a window function</h3>
<section id="pandas-solution-2" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1" class="anchored" data-anchor-id="pandas-solution-2"><span class="header-section-number">4.2.1</span> Pandas solution</h4>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>(</span>
<span id="cb17-2"><a href="#cb17-2"></a>    df_pandas</span>
<span id="cb17-3"><a href="#cb17-3"></a>    .head()</span>
<span id="cb17-4"><a href="#cb17-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_id</th>
      <th>team</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>position</th>
      <th>batting_stance</th>
      <th>at_bats</th>
      <th>obp</th>
      <th>full_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Padres</td>
      <td>juan</td>
      <td>soto</td>
      <td>RF</td>
      <td>L</td>
      <td>524.0</td>
      <td>0.401</td>
      <td>juan soto</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Padres</td>
      <td>Manny</td>
      <td>Machado</td>
      <td>3B</td>
      <td>R</td>
      <td>578.0</td>
      <td>0.366</td>
      <td>Manny Machado</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Padres</td>
      <td>Yu</td>
      <td>Darvish</td>
      <td>P</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Yu Darvish</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Padres</td>
      <td>He-Seong</td>
      <td>Kim</td>
      <td>SS</td>
      <td>R</td>
      <td>517.0</td>
      <td>0.325</td>
      <td>He-Seong Kim</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Padres</td>
      <td>JURICKSON</td>
      <td>PROFAR</td>
      <td>LF</td>
      <td>S</td>
      <td>575.0</td>
      <td>0.331</td>
      <td>JURICKSON PROFAR</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="pyspark-solution-1" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2" class="anchored" data-anchor-id="pyspark-solution-1"><span class="header-section-number">4.2.2</span> PySpark solution</h4>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>(</span>
<span id="cb18-2"><a href="#cb18-2"></a>    df_pyspark</span>
<span id="cb18-3"><a href="#cb18-3"></a>    .<span class="bu">filter</span>(F.col(<span class="st">'position'</span>)<span class="op">!=</span><span class="st">'P'</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a>    .withColumn(<span class="st">'total_at_bats'</span>, F.<span class="bu">sum</span>(<span class="st">'at_bats'</span>).over(W.Window.partitionBy(<span class="st">'team'</span>)))</span>
<span id="cb18-5"><a href="#cb18-5"></a>    .withColumn(<span class="st">'pct_total_at_bats'</span>, F.col(<span class="st">'at_bats'</span>)<span class="op">/</span>F.col(<span class="st">'total_at_bats'</span>))</span>
<span id="cb18-6"><a href="#cb18-6"></a>    .toPandas()</span>
<span id="cb18-7"><a href="#cb18-7"></a>    .head(<span class="dv">3</span>)</span>
<span id="cb18-8"><a href="#cb18-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_id</th>
      <th>team</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>position</th>
      <th>batting_stance</th>
      <th>at_bats</th>
      <th>obp</th>
      <th>total_at_bats</th>
      <th>pct_total_at_bats</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Padres</td>
      <td>juan</td>
      <td>soto</td>
      <td>RF</td>
      <td>L</td>
      <td>524.0</td>
      <td>0.401</td>
      <td>4649.0</td>
      <td>0.112712</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Padres</td>
      <td>Manny</td>
      <td>Machado</td>
      <td>3B</td>
      <td>R</td>
      <td>578.0</td>
      <td>0.366</td>
      <td>4649.0</td>
      <td>0.124328</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>Padres</td>
      <td>He-Seong</td>
      <td>Kim</td>
      <td>SS</td>
      <td>R</td>
      <td>517.0</td>
      <td>0.325</td>
      <td>4649.0</td>
      <td>0.111207</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
</section>
</div>




<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="list quarto-listing-default">

</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>